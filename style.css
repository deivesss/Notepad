/* Black & Purple Notepad - style.css (refatorado) */
:root {
  --bg: #07070a;
  --panel: #0f0d14;
  --muted: #9b8fb7;
  --accent: #7b4cff;
  --accent-2: #b27bff;
  --text: #e8e6f3;
  --dim: #6b6578;
  --spring: cubic-bezier(.68,-0.6,.32,1.6);
}

* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  font-family: Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
  background: linear-gradient(180deg, var(--bg), #08070b 60%);
  color: var(--text);
}

/* Acessibilidade: foco visível consistente */
:focus-visible {
  outline: 2px solid var(--accent-2);
  outline-offset: 2px;
}

/* Animações reduzidas, se preferido pelo usuário */
@media (prefers-reduced-motion: reduce) {
  * { animation: none !important; transition: none !important; }
}

#app {
  display: flex;
  height: 100vh;
  gap: 18px;
  padding: 18px;
}

/* Sidebar */
#sidebar {
  width: 320px;
  max-width: 100vw;
  background: linear-gradient(180deg, rgba(123,76,255,0.08), rgba(255,255,255,0.01));
  border-radius: 18px 18px 12px 12px;
  padding: 14px 8px 10px 8px;
  box-shadow: 0 6px 30px rgba(123,76,255,0.10);
  display: flex;
  flex-direction: column;
  border: 1px solid rgba(123,76,255,0.13);
  min-height: 0; /* evita overflow interno */
  /* Novos ajustes para transição e colapso suave */
  overflow: hidden;
  flex: 0 0 320px;
  transition: transform .28s var(--spring), width .28s var(--spring), padding .28s var(--spring), border-color .28s var(--spring), opacity .2s var(--spring), flex-basis .28s var(--spring);
  will-change: transform, width, opacity;
}

/* estado colapsado (JS alterna classe) */
#sidebar.collapsed {
  /* Em telas grandes, encolhe ocupando 0 no layout */
  flex-basis: 0;
  width: 0;
  padding: 0;
  border-color: transparent;
  opacity: 0;
  transform: translateX(-8px);
  pointer-events: none;
}

.sidebar-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  padding-bottom: 8px;
  border-bottom: 1px solid rgba(123,76,255,0.10);
}

/* Botão de conta */
#accountBtn {
  background: transparent;
  color: var(--accent-2);
  border: 1px solid rgba(123,76,255,0.20);
  width: 36px;
  height: 36px;
  border-radius: 999px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}
#accountBtn:hover { background: rgba(123,76,255,0.10); }

.sidebar-header h1 {
  margin: 0;
  font-size: 20px;
  letter-spacing: 0.4px;
}

#newNoteBtn {
  background: linear-gradient(180deg,var(--accent),var(--accent-2));
  color: #0b0710;
  border: none;
  width: 36px;
  height: 36px;
  border-radius: 8px;
  font-size: 20px;
  cursor: pointer;
  box-shadow: 0 6px 18px rgba(123,76,255,0.18);
}

/* Botão de ocultar a sidebar (acabamento) */
#sidebarToggleBtn {
  background: transparent;
  color: var(--accent-2);
  border: 1px solid rgba(123,76,255,0.20);
  width: 36px;
  height: 36px;
  border-radius: 8px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: transform .18s var(--spring), box-shadow .18s var(--spring), background .18s var(--spring);
}
#sidebarToggleBtn:hover {
  background: rgba(123,76,255,0.10);
  box-shadow: 0 2px 12px rgba(123,76,255,0.10);
  transform: translateY(-1px);
}
#sidebarToggleBtn:active { transform: translateY(0); }

.search-wrap { margin-top: 12px; }
#search {
  width: 100%;
  padding: 10px 12px;
  border-radius: 8px;
  border: 1px solid rgba(255,255,255,0.03);
  background: rgba(255,255,255,0.02);
  color: var(--text);
}

.notes-list {
  list-style: none;
  padding: 8px 0;
  margin: 12px 0 0 0;
  overflow-y: auto;
  overflow-x: hidden; /* evita barra horizontal branca ao hover/transform */
  flex: 1;
  scrollbar-width: thin; /* Firefox */
  scrollbar-color: rgba(123,76,255,0.30) transparent;
}
/* WebKit scrollbars (Chromium/Safari) */
.notes-list::-webkit-scrollbar { width: 10px; height: 10px; }
.notes-list::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, rgba(123,76,255,0.35), rgba(123,76,255,0.18));
  border-radius: 10px;
  border: 2px solid rgba(15,13,20,0.9);
}
.notes-list::-webkit-scrollbar-track { background: transparent; }

.note-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 10px;
  border-radius: 8px;
  cursor: pointer;
  transition: background .18s var(--spring), transform .18s var(--spring), box-shadow .18s var(--spring);
}
.note-item:hover {
  background: rgba(123,76,255,0.09);
  /* Evita overflow horizontal, mantendo uma micro-elevação elegante */
  transform: translateY(-2px);
  box-shadow: 0 2px 12px rgba(123,76,255,0.10);
}
.note-item .note-title { display: block; color: var(--text); }
.note-item .note-meta { color: var(--dim); font-size: 12px; }
.note-item .open-btn {
  background: transparent;
  border: 1px solid rgba(123,76,255,0.12);
  color: var(--accent-2);
  padding: 6px 10px;
  border-radius: 8px;
}
.empty { padding: 18px; color: var(--dim); }

.sidebar-footer {
  display: flex;
  gap: 8px;
  margin-top: 12px;
  flex-wrap: wrap;
}
/* Opções agora ficam no menu da conta */
.sidebar-footer { display: none; }
.sidebar-footer button {
  flex: 1 1 45%;
  padding: 10px 12px;
  border-radius: 10px;
  border: 1px solid rgba(123,76,255,0.10);
  background: linear-gradient(180deg, rgba(123,76,255,0.04), rgba(255,255,255,0.01));
  color: var(--accent-2);
  margin-bottom: 6px;
  font-size: 16px;
}

.auth-wrap { display: flex; gap: 6px; align-items: center; }
.auth-wrap #loginBtn,
.auth-wrap #logoutBtn {
  padding: 8px 10px;
  border-radius: 8px;
  border: 1px solid rgba(123,76,255,0.12);
  background: linear-gradient(180deg,var(--panel), rgba(255,255,255,0.01));
  color: var(--accent-2);
}

/* Editor */
#editorWrap {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 12px;
  min-width: 0; /* evita overflow do editor */
}
.editor-header {
  display: flex;
  gap: 12px;
  align-items: center;
}
#noteTitle {
  flex: 1;
  padding: 12px 14px;
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,0.03);
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  color: var(--text);
  font-size: 16px;
}
.editor-actions { display: flex; gap: 8px; }

/* Popup menus genéricos */
.popup-menu {
  position: absolute;
  z-index: 80;
  min-width: 220px;
  padding: 10px;
  border-radius: 12px;
  border: 1px solid rgba(123,76,255,0.20);
  background: linear-gradient(180deg, rgba(18,14,24,0.94), rgba(18,14,24,0.88));
  backdrop-filter: blur(10px) saturate(120%);
  -webkit-backdrop-filter: blur(10px) saturate(120%);
  box-shadow: 0 14px 40px rgba(0,0,0,0.45);
}
.popup-menu button {
  width: 100%;
  text-align: left;
  padding: 10px 12px;
  border-radius: 10px;
  border: 1px solid rgba(123,76,255,0.16);
  background: linear-gradient(180deg, rgba(123,76,255,0.07), rgba(255,255,255,0.02));
  color: var(--accent-2);
}
.popup-menu button + button { margin-top: 8px; }

/* Menu da conta (posicionado sob o header da sidebar) */
.account-menu {
  left: 12px;
  right: 12px;
  top: 60px;
}
.account-menu .menu-stats { color: var(--muted); font-size: 14px; margin-bottom: 10px; }
.account-menu .menu-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
.account-menu .menu-actions button { text-align: center; }

/* FAB e menu da nota */
#noteActionsFab {
  position: fixed;
  right: 16px;
  bottom: calc(16px + env(safe-area-inset-bottom));
  z-index: 75;
  width: 48px;
  height: 48px;
  border-radius: 999px;
  border: 1px solid rgba(123,76,255,0.25);
  background: linear-gradient(180deg, rgba(123,76,255,0.18), rgba(255,255,255,0.03));
  color: var(--accent-2);
  box-shadow: 0 10px 24px rgba(123,76,255,0.24);
}
.note-actions-menu {
  position: fixed;
  right: 16px;
  bottom: calc(80px + env(safe-area-inset-bottom));
  min-width: 180px;
}
.editor-actions button {
  padding: 10px 12px;
  border-radius: 10px;
  border: 1px solid rgba(123,76,255,0.12);
  background: linear-gradient(180deg,var(--panel), rgba(255,255,255,0.01));
  color: var(--accent-2);
  transition: transform .18s var(--spring), box-shadow .18s var(--spring);
}
.editor-actions button:hover {
  transform: scale(1.07);
  box-shadow: 0 2px 12px rgba(123,76,255,0.10);
}
#editor {
  flex: 1;
  resize: none;
  padding: 18px;
  border-radius: 12px;
  border: none;
  outline: none;
  background: transparent;
  color: var(--text);
  font-size: 15px;
  line-height: 1.5;
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.02);
  min-height: 320px; /* garante altura mínima confortável */
}
.status-bar {
  height: 34px;
  display: flex;
  align-items: center;
  padding: 6px 12px;
  color: var(--dim);
  font-size: 13px;
}

/* Botão flutuante para reabrir a sidebar (mobile/deskop) */
#showSidebarBtn {
  position: fixed;
  top: 12px;
  left: 12px;
  z-index: 40;
  display: none; /* controlado via JS */
  padding: 10px 14px;
  border-radius: 999px;
  border: 1px solid rgba(123,76,255,0.25);
  background: linear-gradient(180deg, rgba(123,76,255,0.18), rgba(255,255,255,0.03));
  color: var(--accent-2);
  box-shadow: 0 6px 24px rgba(123,76,255,0.22);
  transition: transform .18s var(--spring), box-shadow .18s var(--spring);
}
#showSidebarBtn:hover {
  transform: translateY(-1px);
  box-shadow: 0 8px 26px rgba(123,76,255,0.28);
}

/* Quando a sidebar estiver colapsada, reserve espaço para o botão flutuante no topo esquerdo */
.sidebar-collapsed .editor-header { padding-left: 76px; }
@media (max-width: 720px) {
  .sidebar-collapsed .editor-header { padding-left: 56px; }
}

/* Ajustes de posição em telas menores */
@media (max-width: 720px) {
  #showSidebarBtn { top: 8px; left: 8px; padding: 8px 12px; z-index: 50; }
}

/* Auth pages */
.auth-page {
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(180deg, var(--bg), #08070b);
  padding: 20px;
}
.auth-card {
  background: linear-gradient(135deg, rgba(123,76,255,0.10) 0%, rgba(255,255,255,0.01) 100%);
  padding: 28px 18px 22px 18px;
  border-radius: 18px;
  width: 100%;
  max-width: 420px;
  box-shadow: 0 10px 40px rgba(123,76,255,0.13);
  border: 1px solid rgba(123,76,255,0.13);
}
.auth-card h2 {
  margin: 0 0 12px 0;
  font-size: 22px;
  color: var(--accent);
}
.auth-card .muted { color: var(--dim); font-size: 13px; }
.auth-card input {
  width: 100%;
  padding: 12px;
  border-radius: 10px;
  border: 1.5px solid rgba(123,76,255,0.13);
  background: rgba(255,255,255,0.03);
  color: var(--text);
  margin-top: 10px;
  font-size: 16px;
}
.auth-actions {
  display: flex;
  gap: 10px;
  margin: 16px 0 10px 0;
}
.primary {
  background: linear-gradient(90deg,var(--accent),var(--accent-2));
  border: none;
  color: #08070b;
  padding: 10px 16px;
  border-radius: 10px;
  cursor: pointer;
  font-size: 17px;
  font-weight: 500;
  box-shadow: 0 2px 12px rgba(123,76,255,0.10);
  transition: transform .18s var(--spring), box-shadow .18s var(--spring);
}
.primary:hover {
  transform: scale(1.06);
  box-shadow: 0 4px 18px rgba(123,76,255,0.18);
}

/* Login toggle (Entrar / Criar Conta) - evita botão branco no não selecionado */
#formToggle > button {
  padding: 10px 14px;
  border-radius: 12px;
  border: 1px solid rgba(123,76,255,0.20);
  background: linear-gradient(180deg, rgba(123,76,255,0.06), rgba(255,255,255,0.02));
  color: var(--accent-2);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.02);
}
#formToggle > button:hover {
  background: linear-gradient(180deg, rgba(123,76,255,0.10), rgba(255,255,255,0.03));
}
#formToggle > button:active {
  transform: translateY(0);
}
/* Selecionado: aplica o mesmo visual do .primary; mantemos compat com JS que alterna a classe */
#formToggle > button.primary,
#formToggle > button[aria-selected="true"] {
  background: linear-gradient(90deg,var(--accent),var(--accent-2));
  border: none;
  color: #08070b;
  box-shadow: 0 2px 12px rgba(123,76,255,0.10);
}
/* Foco: apenas o ativo recebe realce forte; o inativo fica sutil */
#formToggle > button:focus-visible {
  outline: 2px solid rgba(178,123,255,0.6);
  outline-offset: 2px;
}
#formToggle > button:not(.primary)[aria-selected="false"]:focus-visible {
  outline-color: rgba(178,123,255,0.35);
}

/* Transições elegantes entre Login e Criar Conta */
.auth-card form { will-change: opacity, transform, filter; }
.spring-enter { animation: formEnter .40s var(--spring) both; }
.spring-leave { animation: formLeave .32s var(--spring) both; }

@keyframes formEnter {
  from { opacity: 0; transform: translateY(6px) scale(.98); filter: blur(2px); }
  to   { opacity: 1; transform: translateY(0)  scale(1);   filter: blur(0); }
}
@keyframes formLeave {
  from { opacity: 1; transform: translateY(0)  scale(1);   filter: blur(0); }
  to   { opacity: 0; transform: translateY(-6px) scale(.98); filter: blur(2px); }
}

/* Responsivo */
@media (max-width: 1024px) {
  #sidebar { width: 280px; }
}

@media (max-width: 900px) {
  #sidebar { width: 240px; }
}

@media (max-width: 720px) {
  /* Mantém layout em colunas (sidebar à esquerda) e transforma a sidebar num painel fixo com transição */
  #app { flex-direction: row; padding: 8px; gap: 8px; height: 100vh; min-height: 100vh; }
  .account-menu { left: 8px; right: auto; min-width: 64vw; top: 56px; }
  #noteActionsFab { right: 12px; bottom: calc(12px + env(safe-area-inset-bottom)); width: 46px; height: 46px; }
  .note-actions-menu { right: 12px; bottom: calc(72px + env(safe-area-inset-bottom)); }
}

  /* Sidebar fixa na esquerda com slide-in/out */
  #sidebar {
    position: fixed;
    left: 8px;
    top: 8px;
    bottom: 8px;
    height: auto;
    width: min(78vw, 320px);
    max-width: 88vw;
    flex: 0 0 auto; /* não participa do fluxo do flex container quando fixa */
    z-index: 60;
    padding: 12px 8px 10px 8px;
    transform: translateX(0);
    opacity: 1;
    /* Fundo opaco com glass + blur para não deixar o texto do editor transparecer */
    background: linear-gradient(180deg, rgba(123,76,255,0.10), rgba(255,255,255,0.03)), rgba(18,14,24,0.94);
    backdrop-filter: blur(10px) saturate(120%);
    -webkit-backdrop-filter: blur(10px) saturate(120%);
  }
  #sidebar.collapsed {
    /* no mobile, desliza para fora em vez de encolher a largura */
    transform: translateX(calc(-100% - 12px));
    width: min(78vw, 320px);
    padding: 12px 8px 10px 8px;
    border-color: rgba(123,76,255,0.13);
    opacity: 0;
  }

  #editorWrap { order: 0; }
  .sidebar-header h1 { font-size: 18px; }
  .editor-header { flex-direction: column; gap: 8px; align-items: stretch; }
  #noteTitle { font-size: 16px; padding: 10px; }
  .editor-actions button { font-size: 15px; padding: 8px 10px; }
  #editor { padding: 14px; font-size: 15px; min-height: 48vh; }
}

@media (max-width: 480px) {
  html, body { font-size: 15px; }
  #app { padding: 6px; }
  #sidebar { padding: 8px; }
  .sidebar-header { gap: 6px; }
  .sidebar-header h1 { font-size: 16px; }
  #newNoteBtn { width: 32px; height: 32px; font-size: 18px; }
  .search-wrap { margin-top: 6px; }
  #search { padding: 8px 8px; font-size: 15px; }
  .notes-list { padding: 4px 0; margin: 8px 0 0 0; }
  .note-item { padding: 8px; gap: 8px; }
  .note-item .note-title { font-size: 15px; }
  .note-item .note-meta { font-size: 11px; }
  .note-item .open-btn { padding: 6px 10px; font-size: 14px; }
  .sidebar-footer { gap: 6px; margin-top: 8px; }
  .sidebar-footer button { padding: 8px 8px; font-size: 14px; }
  .auth-wrap #loginBtn,
  .auth-wrap #logoutBtn { padding: 7px 8px; font-size: 14px; }
  #editorWrap { gap: 8px; }
  .editor-header { gap: 8px; }
  #noteTitle { padding: 10px; font-size: 15px; }
  .editor-actions button { padding: 8px 10px; font-size: 14px; }
  #editor { padding: 12px; font-size: 15px; min-height: 52vh; }
  .status-bar { height: 30px; padding: 6px 10px; font-size: 12px; }
  .auth-card { width: 98vw; padding: 12px; }
}

/* Melhorias específicas para mobile: barra de ações e destaque dos campos */
@media (max-width: 720px) {
  /* Destaque mais visível das caixas de texto */
  #noteTitle,
  #editor {
    border: 1.5px solid rgba(123,76,255,0.32) !important;
    box-shadow: inset 0 0 0 2px rgba(123,76,255,0.14);
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.00));
  }

  /* No mobile, ocultamos os botões clássicos e usamos o FAB + popup */
  .editor-actions { display: none; }
}

/* Mobile: bloqueio visual quando a sidebar está expandida (evita teclado abrir) */
@media (max-width: 720px) {
  body.editor-locked #noteTitle,
  body.editor-locked #editor {
    pointer-events: none;
    user-select: none;
    opacity: .8;
    border-style: dashed !important;
    border-color: rgba(123,76,255,0.38) !important;
    box-shadow: inset 0 0 0 2px rgba(123,76,255,0.16);
    cursor: not-allowed;
  }
}
